# Tongbu.Tui.Nms.Inner é¡¹ç›®æäº¤è·å–å·¥å…· - å®Œæ•´ä½¿ç”¨æŒ‡å—

## ğŸ“‹ é¡¹ç›®é…ç½®ä¿¡æ¯

- **é¡¹ç›® ID**: `508`
- **é¡¹ç›®åç§°**: `Tongbu.Tui.Nms.Inner`
- **Git ç«™ç‚¹**: `http://git.server.tongbu.com/`
- **å®Œæ•´è·¯å¾„**: `http://git.server.tongbu.com/tuigroup/tongbu.tui.nms.inner`
- **Access Token**: `JyxNC-T2QxK-wDursXPs`
- **API åœ°å€**: `http://git.server.tongbu.com/api/v4`

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆä¸‰ç§æ–¹å¼ï¼‰

### æ–¹å¼ 1: ç›´æ¥è¿è¡Œï¼ˆæœ€ç®€å•ï¼‰âœ¨

```bash
# è·å– dev åˆ†æ”¯æœ€æ–° 20 æ¡æäº¤ï¼ˆJSON æ ¼å¼ï¼‰
python fetch_tongbu_commits.py
```

**è¾“å‡º**: å®Œæ•´çš„ JSON æ ¼å¼æ•°æ® + å¯è¯»æ ¼å¼æ‘˜è¦

---

### æ–¹å¼ 2: ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼ˆæ›´å®‰å…¨ï¼‰ğŸ”’

```bash
# é¦–æ¬¡ä½¿ç”¨ï¼šå¤åˆ¶é…ç½®æ–‡ä»¶
copy config_example.json config.json

# ç„¶åç›´æ¥è¿è¡Œ
python fetch_with_config.py
```

**ä¼˜ç‚¹**: Token ä¸æš´éœ²åœ¨ä»£ç ä¸­ï¼Œæ›´å®‰å…¨

---

### æ–¹å¼ 3: åœ¨ Python ä»£ç ä¸­è°ƒç”¨ ğŸ“

```python
from fetch_tongbu_commits import fetch_tongbu_commits
import json

# è·å–æäº¤
result = fetch_tongbu_commits(branch='dev', per_page=20)

# è¾“å‡º JSON
print(json.dumps(result, indent=2, ensure_ascii=False))
```

---

## ğŸ“– è¯¦ç»†ä½¿ç”¨ç¤ºä¾‹

### 1. è·å–ä¸åŒåˆ†æ”¯çš„æäº¤

```bash
# dev åˆ†æ”¯ï¼ˆé»˜è®¤ï¼‰
python fetch_tongbu_commits.py --branch dev

# master åˆ†æ”¯
python fetch_tongbu_commits.py --branch master

# ä»»æ„åˆ†æ”¯
python fetch_tongbu_commits.py --branch feature/new-feature
```

### 2. æŒ‡å®šè·å–æ•°é‡

```bash
# è·å–æœ€æ–° 10 æ¡
python fetch_tongbu_commits.py --per-page 10

# è·å–æœ€æ–° 50 æ¡
python fetch_tongbu_commits.py --per-page 50

# è·å–æœ€æ–° 100 æ¡
python fetch_tongbu_commits.py --per-page 100
```

### 3. ä¿å­˜åˆ° JSON æ–‡ä»¶

```bash
# ä¿å­˜åˆ°æ–‡ä»¶
python fetch_tongbu_commits.py --output commits.json

# è‡ªå®šä¹‰æ–‡ä»¶å
python fetch_tongbu_commits.py --output dev_commits_20250130.json

# æŒ‡å®šåˆ†æ”¯å’Œæ•°é‡ï¼Œå¹¶ä¿å­˜
python fetch_tongbu_commits.py --branch dev --per-page 30 --output result.json
```

### 4. åªè¾“å‡º JSONï¼ˆä¸æ˜¾ç¤ºæ‘˜è¦ï¼‰

```bash
# åªè¾“å‡º JSON
python fetch_tongbu_commits.py --json-only

# è¾“å‡ºåˆ°æ–‡ä»¶ï¼ˆç®¡é“ï¼‰
python fetch_tongbu_commits.py --json-only > output.json
```

### 5. ç»„åˆä½¿ç”¨

```bash
# æœ€å¸¸ç”¨ï¼šè·å– dev åˆ†æ”¯æœ€æ–° 20 æ¡ï¼Œä¿å­˜åˆ°æ–‡ä»¶
python fetch_tongbu_commits.py --branch dev --per-page 20 --output today_commits.json

# è·å– master åˆ†æ”¯æœ€æ–° 5 æ¡ï¼Œåªæ˜¾ç¤º JSON
python fetch_tongbu_commits.py --branch master --per-page 5 --json-only
```

---

## ğŸ§ª æµ‹è¯•åŠŸèƒ½

è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯åŠŸèƒ½ï¼š

```bash
python test_tongbu.py
```

**æµ‹è¯•å†…å®¹**:
- âœ… Dev åˆ†æ”¯è·å–æµ‹è¯•
- âœ… Master åˆ†æ”¯è·å–æµ‹è¯•
- âœ… JSON æ•°æ®ç»“æ„éªŒè¯

---

## ğŸ“Š è¿”å›çš„ JSON æ•°æ®æ ¼å¼

```json
{
  "success": true,
  "count": 20,
  "error": null,
  "commits": [
    {
      "id": "a1b2c3d4e5f6...",
      "short_id": "a1b2c3d4",
      "title": "æäº¤æ ‡é¢˜",
      "message": "å®Œæ•´çš„æäº¤æ¶ˆæ¯\nå¯èƒ½åŒ…å«å¤šè¡Œ",
      "author_name": "å¼ ä¸‰",
      "author_email": "zhangsan@example.com",
      "authored_date": "2025-01-30T10:30:00.000+08:00",
      "committer_name": "å¼ ä¸‰",
      "committer_email": "zhangsan@example.com",
      "committed_date": "2025-01-30T10:30:00.000+08:00",
      "web_url": "http://git.server.tongbu.com/tuigroup/tongbu.tui.nms.inner/-/commit/a1b2c3d4"
    }
  ]
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `success` | boolean | æ˜¯å¦æˆåŠŸè·å– |
| `count` | integer | è·å–åˆ°çš„æäº¤æ•°é‡ |
| `error` | string/null | é”™è¯¯ä¿¡æ¯ï¼ˆæˆåŠŸæ—¶ä¸º nullï¼‰ |
| `commits` | array | æäº¤åˆ—è¡¨ |
| `commits[].id` | string | å®Œæ•´çš„ commit ID |
| `commits[].short_id` | string | çŸ­ commit ID |
| `commits[].title` | string | æäº¤æ ‡é¢˜ï¼ˆç¬¬ä¸€è¡Œï¼‰ |
| `commits[].message` | string | å®Œæ•´çš„æäº¤æ¶ˆæ¯ |
| `commits[].author_name` | string | ä½œè€…åç§° |
| `commits[].author_email` | string | ä½œè€…é‚®ç®± |
| `commits[].authored_date` | string | æäº¤æ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰ |
| `commits[].web_url` | string | æäº¤çš„ç½‘é¡µé“¾æ¥ |

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶å | è¯´æ˜ |
|--------|------|
| `git_commits_fetcher.py` | æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼ˆé€šç”¨ï¼‰ |
| `fetch_tongbu_commits.py` | **ä¸“é—¨é’ˆå¯¹ Tongbu é¡¹ç›®çš„è„šæœ¬ï¼ˆæ¨èä½¿ç”¨ï¼‰** |
| `fetch_with_config.py` | ä½¿ç”¨é…ç½®æ–‡ä»¶çš„ç‰ˆæœ¬ï¼ˆæ›´å®‰å…¨ï¼‰ |
| `config_example.json` | é…ç½®æ–‡ä»¶ç¤ºä¾‹ |
| `test_tongbu.py` | æµ‹è¯•è„šæœ¬ |
| `example_usage.py` | é€šç”¨ä½¿ç”¨ç¤ºä¾‹ |
| `requirements.txt` | Python ä¾èµ–åŒ… |

---

## ğŸ”§ Python ä»£ç è°ƒç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: åŸºæœ¬ä½¿ç”¨

```python
from fetch_tongbu_commits import fetch_tongbu_commits
import json

# è·å– dev åˆ†æ”¯æœ€æ–° 20 æ¡æäº¤
result = fetch_tongbu_commits(branch='dev', per_page=20)

if result['success']:
    print(f"æˆåŠŸè·å– {result['count']} æ¡æäº¤")
    
    # æ‰“å°æ¯æ¡æäº¤çš„æ ‡é¢˜
    for commit in result['commits']:
        print(f"- {commit['title']}")
else:
    print(f"å¤±è´¥: {result['error']}")
```

### ç¤ºä¾‹ 2: è·å–å¹¶åˆ†ææäº¤

```python
from fetch_tongbu_commits import fetch_tongbu_commits
from datetime import datetime

result = fetch_tongbu_commits(branch='dev', per_page=50)

if result['success']:
    # ç»Ÿè®¡å„ä¸ªä½œè€…çš„æäº¤æ•°
    authors = {}
    for commit in result['commits']:
        author = commit['author_name']
        authors[author] = authors.get(author, 0) + 1
    
    print("æäº¤ç»Ÿè®¡:")
    for author, count in sorted(authors.items(), key=lambda x: x[1], reverse=True):
        print(f"  {author}: {count} æ¡æäº¤")
```

### ç¤ºä¾‹ 3: ä¿å­˜ç‰¹å®šå­—æ®µ

```python
from fetch_tongbu_commits import fetch_tongbu_commits
import json

result = fetch_tongbu_commits(branch='dev', per_page=20)

if result['success']:
    # åªä¿å­˜éœ€è¦çš„å­—æ®µ
    simplified = []
    for commit in result['commits']:
        simplified.append({
            'id': commit['short_id'],
            'title': commit['title'],
            'author': commit['author_name'],
            'date': commit['authored_date']
        })
    
    # ä¿å­˜åˆ°æ–‡ä»¶
    with open('simplified_commits.json', 'w', encoding='utf-8') as f:
        json.dump(simplified, f, indent=2, ensure_ascii=False)
```

---

## â“ å¸¸è§é—®é¢˜

### 1. å¦‚ä½•è·å–æ›´å¤šçš„æäº¤ï¼Ÿ

ä½¿ç”¨ `--per-page` å‚æ•°ï¼š
```bash
python fetch_tongbu_commits.py --per-page 100
```

### 2. å¦‚ä½•è·å–æ‰€æœ‰åˆ†æ”¯ï¼Ÿ

æ¯æ¬¡åªèƒ½è·å–ä¸€ä¸ªåˆ†æ”¯ï¼Œéœ€è¦å¤šæ¬¡è°ƒç”¨ï¼š
```bash
python fetch_tongbu_commits.py --branch dev --output dev.json
python fetch_tongbu_commits.py --branch master --output master.json
```

### 3. è·å–å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
- âœ… ç½‘ç»œæ˜¯å¦å¯ä»¥è®¿é—® `http://git.server.tongbu.com/`
- âœ… Access Token æ˜¯å¦æœ‰æ•ˆ
- âœ… Project ID æ˜¯å¦æ­£ç¡®ï¼ˆåº”è¯¥æ˜¯ `508`ï¼‰
- âœ… åˆ†æ”¯åç§°æ˜¯å¦å­˜åœ¨

### 4. å¦‚ä½•åªè·å–ç‰¹å®šæ—¶é—´èŒƒå›´çš„æäº¤ï¼Ÿ

GitLab API æ”¯æŒæ—¶é—´è¿‡æ»¤ï¼Œéœ€è¦ä¿®æ”¹ä»£ç æ·»åŠ  `since` å’Œ `until` å‚æ•°ã€‚

### 5. Token ä¼šè¿‡æœŸå—ï¼Ÿ

æ˜¯çš„ï¼ŒGitLab Access Token å¯èƒ½ä¼šè®¾ç½®è¿‡æœŸæ—¶é—´ã€‚å¦‚æœ Token è¿‡æœŸï¼Œéœ€è¦é‡æ–°ç”Ÿæˆã€‚

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### å®‰å…¨æ€§
- ğŸ”’ **ä¸è¦å°† Token æäº¤åˆ°å…¬å…±ä»£ç ä»“åº“**
- ğŸ”’ å»ºè®®ä½¿ç”¨ `fetch_with_config.py` + `config.json` çš„æ–¹å¼
- ğŸ”’ åœ¨ `.gitignore` ä¸­æ·»åŠ  `config.json`

### æ€§èƒ½
- ğŸ“Š GitLab API æœ‰é€Ÿç‡é™åˆ¶ï¼ˆé€šå¸¸æ˜¯æ¯åˆ†é’Ÿ 600 æ¬¡è¯·æ±‚ï¼‰
- ğŸ“Š å•æ¬¡æœ€å¤šè·å– 100 æ¡æäº¤ï¼ˆ`--per-page 100`ï¼‰
- ğŸ“Š å¦‚éœ€è·å–æ›´å¤šï¼Œéœ€è¦ä½¿ç”¨åˆ†é¡µï¼ˆpaginationï¼‰

### ç½‘ç»œ
- ğŸŒ ç¡®ä¿è¿è¡Œç¯å¢ƒå¯ä»¥è®¿é—®å†…ç½‘ GitLab
- ğŸŒ å¦‚æœ‰ä»£ç†ï¼Œå¯èƒ½éœ€è¦é…ç½®ç¯å¢ƒå˜é‡

---

## ğŸ¯ æœ€ä½³å®è·µ

### æ—¥å¸¸ä½¿ç”¨æ¨è

```bash
# æ¯æ—¥æŸ¥çœ‹æœ€æ–°æäº¤
python fetch_tongbu_commits.py --branch dev --per-page 10

# å‘¨æŠ¥ï¼šè·å–ä¸€å‘¨çš„æäº¤ï¼ˆçº¦ 50 æ¡ï¼‰
python fetch_tongbu_commits.py --branch dev --per-page 50 --output weekly_report.json
```

### è‡ªåŠ¨åŒ–è„šæœ¬

```python
# auto_fetch.py
from fetch_tongbu_commits import fetch_tongbu_commits
from datetime import datetime
import json

# è·å–æäº¤
result = fetch_tongbu_commits(branch='dev', per_page=30)

if result['success']:
    # è‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶åï¼ˆåŒ…å«æ—¥æœŸï¼‰
    filename = f"commits_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
    
    with open(filename, 'w', encoding='utf-8') as f:
        json.dump(result, f, indent=2, ensure_ascii=False)
    
    print(f"å·²ä¿å­˜åˆ°: {filename}")
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. ç½‘ç»œè¿æ¥
2. Token æœ‰æ•ˆæ€§
3. é¡¹ç›® ID æ­£ç¡®æ€§
4. åˆ†æ”¯æ˜¯å¦å­˜åœ¨

---

## ğŸ“ æ›´æ–°æ—¥å¿—

- **2025-01-30**: åˆ›å»ºå®Œæ•´çš„ Tongbu é¡¹ç›®æäº¤è·å–å·¥å…·
  - âœ… æ”¯æŒ dev/master ç­‰åˆ†æ”¯
  - âœ… æ”¯æŒ JSON æ ¼å¼è¾“å‡º
  - âœ… æ”¯æŒä¿å­˜åˆ°æ–‡ä»¶
  - âœ… æä¾›æµ‹è¯•è„šæœ¬
  - âœ… æ”¯æŒé…ç½®æ–‡ä»¶æ–¹å¼

---

## ğŸ‰ å¿«é€Ÿä¸Šæ‰‹

**æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼ï¼š**

```bash
# 1. å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰
pip install requests

# 2. ç›´æ¥è¿è¡Œ
python fetch_tongbu_commits.py

# 3. å®Œæˆï¼æŸ¥çœ‹ JSON è¾“å‡º
```

**å°±è¿™ä¹ˆç®€å•ï¼** ğŸš€

